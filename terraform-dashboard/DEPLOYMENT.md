# üöÄ Terraform Dashboard - Simple Deployment Guide

This guide provides multiple simple deployment options for the Terraform Dashboard application.

## üìã Prerequisites

- **Node.js 18+** and **npm**
- **Docker** and **Docker Compose** (for containerized deployment)
- **PM2** (automatically installed by deployment script)
- **AWS CLI** configured (optional, for AWS integration)

## üéØ Quick Start Options

### Option 1: One-Command Deployment (Recommended)

```bash
# Make deployment script executable
chmod +x deploy.sh

# Deploy in production mode
./deploy.sh deploy

# Or deploy in development mode
./deploy.sh dev
```

### Option 2: Docker Deployment

```bash
# Build and start with Docker Compose
docker-compose -f docker-compose.simple.yml up -d

# With nginx reverse proxy
docker-compose -f docker-compose.simple.yml --profile nginx up -d

# View logs
docker-compose -f docker-compose.simple.yml logs -f
```

### Option 3: Manual Deployment

```bash
# Install dependencies
npm install
cd backend && npm install && cd ..
cd frontend && npm install && cd ..

# Build applications
cd backend && npm run build && cd ..
cd frontend && npm run build && cd ..

# Start with PM2
npm install -g pm2 serve
pm2 start ecosystem.config.js
```

## üîß Deployment Script Commands

The `deploy.sh` script supports multiple commands:

```bash
./deploy.sh deploy      # Production deployment with PM2
./deploy.sh dev         # Development mode
./deploy.sh status      # Show application status
./deploy.sh stop        # Stop the application
./deploy.sh restart     # Restart the application
./deploy.sh help        # Show help
```

## üåê Access URLs

After deployment, access the application at:

- **Frontend**: http://localhost:3000
- **Backend API**: http://localhost:5000
- **Health Check**: http://localhost:5000/api/health

With nginx reverse proxy:
- **Application**: http://localhost (port 80)

## üîê Default Credentials

- **Username**: `admin`
- **Password**: `admin123`

‚ö†Ô∏è **Important**: Change the default password after first login!

## üìÅ Configuration Files

### Environment Configuration (`backend/.env`)

```bash
# Server Configuration
PORT=5000
NODE_ENV=production
FRONTEND_URL=http://localhost:3000

# Database Configuration
DATABASE_PATH=./data/terraform-dashboard.db

# JWT Configuration
JWT_SECRET=your-super-secret-jwt-key-change-this

# AWS Configuration
AWS_REGION=us-east-1
AWS_PROFILE=default

# Terraform Configuration
TERRAFORM_PATH=/usr/local/bin/terraform
TERRAGRUNT_PATH=/usr/local/bin/terragrunt
TERRAFORM_WORKING_DIR=./terraform-workspace
```

### PM2 Configuration (`ecosystem.config.js`)

Automatically generated by the deployment script. Manages both backend and frontend processes.

## üê≥ Docker Configuration

### Environment Variables

Set these in your `.env` file or docker-compose:

```bash
JWT_SECRET=your-secret-key
AWS_REGION=us-east-1
AWS_PROFILE=default
```

### Volumes

- `terraform_data`: Database persistence
- `terraform_logs`: Application logs
- `terraform_workspace`: Terraform working directory
- `~/.aws`: AWS credentials (mounted read-only)
- `~/.ssh`: SSH keys for Git operations

## üîç Monitoring and Logs

### PM2 Commands

```bash
pm2 status                           # Show process status
pm2 logs terraform-dashboard-backend # Backend logs
pm2 logs terraform-dashboard-frontend # Frontend logs
pm2 restart all                      # Restart all processes
pm2 stop all                         # Stop all processes
pm2 delete all                       # Delete all processes
```

### Docker Commands

```bash
docker-compose -f docker-compose.simple.yml logs -f  # Follow logs
docker-compose -f docker-compose.simple.yml ps       # Show containers
docker-compose -f docker-compose.simple.yml restart  # Restart services
docker-compose -f docker-compose.simple.yml down     # Stop and remove
```

## üõ°Ô∏è Security Considerations

### Production Deployment

1. **Change default credentials** immediately
2. **Set strong JWT secret** in environment variables
3. **Configure HTTPS** with SSL certificates
4. **Set up firewall rules** to restrict access
5. **Regular security updates** for dependencies

### Environment Variables

```bash
# Generate secure JWT secret
openssl rand -base64 32

# Set in environment
export JWT_SECRET="your-generated-secret"
```

## üîß Troubleshooting

### Common Issues

1. **Port conflicts**: Change ports in environment variables
2. **Permission errors**: Ensure proper file permissions
3. **Database issues**: Check database file permissions
4. **AWS access**: Verify AWS credentials and permissions

### Health Checks

```bash
# Check backend health
curl http://localhost:5000/api/health

# Check if processes are running
pm2 status

# Check Docker containers
docker-compose -f docker-compose.simple.yml ps
```

### Log Locations

- **PM2 Logs**: `~/.pm2/logs/`
- **Application Logs**: `backend/logs/`
- **Docker Logs**: `docker-compose logs`

## üöÄ Advanced Deployment

### Load Balancer Setup

For high availability, deploy multiple instances behind a load balancer:

```bash
# Scale with Docker Compose
docker-compose -f docker-compose.simple.yml up -d --scale terraform-dashboard=3
```

### Database Backup

```bash
# Backup SQLite database
cp backend/data/terraform-dashboard.db backup/terraform-dashboard-$(date +%Y%m%d).db

# Automated backup script
echo "0 2 * * * cp /path/to/backend/data/terraform-dashboard.db /path/to/backup/terraform-dashboard-\$(date +\%Y\%m\%d).db" | crontab -
```

## üìû Support

For issues and questions:

1. Check the logs for error messages
2. Verify all prerequisites are installed
3. Ensure proper network connectivity
4. Check AWS credentials and permissions

## üîÑ Updates

To update the application:

```bash
# Pull latest changes
git pull origin main

# Restart deployment
./deploy.sh restart
```

For Docker:

```bash
# Rebuild and restart
docker-compose -f docker-compose.simple.yml up -d --build
```
